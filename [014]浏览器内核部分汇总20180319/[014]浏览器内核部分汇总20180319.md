[问题：从输入URL到页面完全渲染出浏览器都做了什么？](https://segmentfault.com/a/1190000013662126#articleHeader51)

这个问题都是老生常谈的问题了，要比较系统的回答，可以从下面这样的思路回答：
1. 从浏览器接收URL到开启网络请求线程（这一部分可以展开浏览器的机制以及进程和线程之前的关系）
2. 开启网络请求线程到发出一个完整的http请求（这一部分涉及DNS查询，tcp/ip请求，5层互联网协议栈等知识）
3. 从服务器接收到请求到对应后台接收到请求（这一部分涉及到负载均衡，安全拦截以及后台内部的处理等等）
4. 后台与前台http交互（这一部分涉及到http头部、响应码、报文结构、cookie等知识）
5. 缓存问题，关于http的缓存问题（这部分包含http缓存头部，rtag。catch-control等）
6. 浏览器接收到http数据包后的解析流程（解析html-词法分析然后解析成DOM树、解析css生成css规则树、合并成render树，然后layout）
7. css可视化格式模型（元素的渲染规则，如包含块、控制框、BFC、IFC等）
8. js引擎解析过程（js的解释阶段，预处理阶段，执行阶段生成执行上下文，vo，作用域链，回收机制等等）
9. 其他拓展（如跨域、web安全等等）

## 从浏览器接收URL到开启网络请求线程

浏览器是多进程的，主要进程包括：
* Browser进程：浏览器的主进程（负责协调、主控），只有一个
* 第三方插件进程：一般每种插件对应一个进程
* GPU进程：最多一个，用户3D绘制等
* 浏览器渲染进程（浏览器内核）（Render进程，内部是多线程的），主要作用是页面渲染、脚本执行、事件处理等，以下是一些常用线程：
    - GUI渲染线程
    - JS引擎线程
    - 事件触发线程
    - 定时器触发进程
    - 异步http请求线程
    <!-- Todo：浏览器内核下各线程之间的作用和联系 -->

## 开启网络请求线程到发出一个完整的http请求

1. DNS查询到ip地址

    如果输入的是域名，需要进行dns解析成ip，大致流程为：如果浏览器有缓存，直接使用浏览器缓存，否则使用本机缓存，再没有的话就使用host；如果本地没有，就向dns域名服务器查询。

    > 注意，需要知道DNS解析是很耗时的，因此如果解析域名过多，会让首页加载变慢，可以考虑`dns-prefetch`优化（所以这个地方就可以有拓展的优化方案了）

2. tcp/ip请求

    http本质就是tcp/ip请求，需要了解的是3次握手规则建立连接和4次挥手的断开连接

    浏览器对同一域名下并发的tcp连接是有限制的（2-10不等），但是http1.0中往往一个资源下载就需要对应一个tcp/ip请求，所以针对这个瓶颈，又出现了很多的优化方案

3. 5层因特网协议栈

    从**应用层**的发送http请求，到**传输层**通过三次握手建立tcp/ip连接，再到**网络层**的ip寻址，再到**数据链路层**的封装成帧，最后到**物理层**的利用物理介质传输。
    
## 从服务器接收到请求到对应后台接收到请求

这块主要涉及后台部分，不展开。

## 后台与前台http交互

1. http报文结构：报文一般包括了：通用头部、请求/响应头部、请求/响应体
2. 状态码
    
    - 200   OK
    - 304   自从上次请求后，请求的网页未修改过，请使用客户端本地缓存
    - 400   客户端请求参数有错（也有可能安全模式拦截）
    - 401   请求未经过授权
    - 403   禁止访问（比如未登录时禁止）
    - 404   资源未找到，URL错误
    - 500   服务器内部错误
    - 503   服务器不可用

## 浏览器接收到http数据包后的解析流程
## css可视化格式模型
## js引擎解析过程